name: crictl
steps:
- sources:
  - url: https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.15.0/crictl-v1.15.0-linux-amd64.tar.gz
    destination: crictl-v1.15.0-linux-amd64.tar.gz
    sha256: c3b71be1f363e16078b51334967348aab4f72f46ef64a61fe7754e029779d45a
    sha512: 4e73005ec6a0aa0e676252e78ab352733114aa036dc3287bef9e4a33054c4f1445a2007095fee217e74ced5c79b242d6653eade95db5bf8a6f8f029db24a0b5a
  - url: https://github.com/kubernetes-sigs/cri-tools/releases/download/v1.15.0/crictl-v1.15.0-linux-arm64.tar.gz
    destination: crictl-v1.15.0-linux-arm64.tar.gz
    sha256: 785c3da7e058f6fd00b0a48de24b9199eb6bae940d13f509c44ea6dd7ad9ffcd
    sha512: 846d1453e1a046752acbcebd10bd50df0b37c90e4b114188e7492bb0cfc0c8e226b9fbaf1e7a19ef0f29765bf7330ac233cd8e5062b1eaea58722dad10b6a9dd
  install:
  - |
    mkdir -p /rootfs/bin

    case $ARCH in
        x86_64)
            tar -xzvf crictl-v1.15.0-linux-amd64.tar.gz -C /rootfs/bin
        ;;
        aarch64)
            tar -xzvf crictl-v1.15.0-linux-arm64.tar.gz -C /rootfs/bin
        ;;
        *)
            echo "unsupported arch ${ARCH}"
            exit 1
        ;;
    esac
finalize:
- from: /rootfs
  to: /
