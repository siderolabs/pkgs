name: kubeadm
steps:
- sources:
  - url: https://storage.googleapis.com/kubernetes-release/release/v1.16.0/bin/linux/amd64/kubeadm
    destination: kubeadm-linux-amd64
    sha256: 18f30d65fb05148c73cc07c77a83f4a2427379af493ca9f60eda42239409e7ef
    sha512: 2974237f907d4f6a523d8f38f5f645ae14d86ef70a34f1dc41bed47358b024d385ba2aeca7d9a2007643c3e518fac5dfce922c19418715969039d74c82d99786
  - url: https://storage.googleapis.com/kubernetes-release/release/v1.16.0/bin/linux/arm64/kubeadm
    destination: kubeadm-linux-arm64
    sha256: 9a1d21bfb6bd15697ac010665e5917a5364b340d5b60f2f0302c179d75da0f3f
    sha512: 6b12be26d8dacfcffe48105823df9e8701ced71db3dd4c87f30fd9bb7c2ca087242e5b872ac1de5c8a5c45a9b135142627ff5786b62d05cc51c832469541b22b
  install:
  - |
    mkdir -p /rootfs/bin

    case $ARCH in
        x86_64)
            cp kubeadm-linux-amd64 /rootfs/bin/kubeadm
        ;;
        aarch64)
            cp kubeadm-linux-arm64 /rootfs/bin/kubeadm
        ;;
        *)
            echo "unsupported arch ${ARCH}"
            exit 1
        ;;
    esac

    chmod +x /rootfs/bin/kubeadm
finalize:
- from: /rootfs
  to: /
